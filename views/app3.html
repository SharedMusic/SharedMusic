<!DOCTYPE html>

<html>
	<head>
		<title>Jukebox - Share and listen to music with friends</title>

		<link rel="shortcut icon" href="/images/favicon.png">
		
		<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

		<!-- Bootstrap -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

		<!-- Default theme -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">

		<link rel="stylesheet" type="text/css" href="/style/Metrojs.css">
		<link rel="stylesheet" type="text/css" href="/style/tileTest.css">
		<link rel="stylesheet" type="text/css" href="/style/app3.css">
		<link rel="stylesheet" type="text/css" href="/style/nanoScroller.css">
		<script src="/js/flip.js"></script>
		<link href="http://fonts.googleapis.com/css?family=Raleway:400,700,600,500,300,200,100,800,900" rel="stylesheet" type="text/css">

		<!-- nanoScroller -->
		<script src="/js/nanoScroller.js"></script>

		<!-- Angular -->
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>

		<!-- socket.io -->
		<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>

		<!-- SoundCloud -->
		<script src="http://connect.soundcloud.com/sdk.js"></script>

		<!-- Requirejs script importing -->
		<script data-main="../js/main.js" src="../js/require.js"></script>

		<script src="/js/MetroJs.js"></script>
		<script src="/js/tiles.js"></script>

		<script>
			$(window).load(function(){
				$('#myModal').modal('show');
			});
			$(document).ready(function(){
				function getParameterByName(name) {
						name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
						var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
								results = regex.exec(location.search);
						return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
				}

				$('#roomID').hide();
				var count = 0;
				var timer = setInterval(function () {
					count++;
						//$("#roomID").val(getParameterByName('roomID'));
						//$("roomID").trigger('input');

						var input = $('#roomID');
						input.val(getParameterByName('roomID'));
						input.trigger('input');

						if(count > 10) {
							clearInterval(timer);
						}
					}, 100);
				$('#myModal').modal({backdrop: 'static', keyboard: false});
				$("#enterRoom").click(function() {
					$('#myModal').modal('hide');

				});
				$("#volumeControl").on("input change", function() { 
					var percent = this.value/100;
					var marginLeft = 5+percent * (125);

					document.getElementById("volumeText").style.marginLeft = marginLeft + "px";
				});
				$("div.tiles").fadeIn(5000);
			}); 
		</script>
	</head>
	<body>
		<!-- Modal -->
		<div id="myModal" class="modal fade" role="dialog">
		  <div class="modal-dialog">

			<!-- Modal content-->
			<div class="modal-content">
			  <div ng-controller="UserController as userList" class="modal-body">
				<h1 class="welcome">Welcome to Jukebox</h1>
				<hr class="welcome">
				<form ng-submit="userList.addUser()">
					<input class="welcomeInput" type="text" ng-model="userList.temp.name" ng-disabled="button" required ng-init="button = false" size="25" placeholder="Enter your name">
					<input id="roomID" type="text" ng-model="userList.temp.roomID">
					<input ng-click="button = true" id="enterRoom" class="welcomeButton btn btn-primary btn-xs" type="submit" value="Join  Room">
				</form>
			  </div>
			</div>

		  </div>
		</div>
		<script>
			$(".welcomeInput")[0].focus();
		</script>

		<div class="leftContainer">
			<a href="/"><div class="logo">
				<img class="logo" src="/images/dark-logo-t.png">
			</div></a>
			<div class="currentSong" ng-controller="MusicPlayer as musicplayer">
				<a href="{{musicplayer.getLink}}">
					<div class="albumArt" style="background-image: url({{musicplayer.getAlbumArt()}});">
						<div class="time">
							<p class="time">{{musicplayer.millisToMinutesAndSeconds(musicplayer.currentTrackTime)}} of {{musicplayer.millisToMinutesAndSeconds(musicplayer.trackInfo.duration)}}</p>
						</div>
					</div>
				</a>
				<div class="songInfo">
					<h1 class="songTitle">{{musicplayer.trackInfo.title}}</h1>
					<p class="artistName">{{musicplayer.trackInfo.username}}</p>
				</div>
				<div class="musicButtonContainer">
					<button ng-click="musicplayer.muteSong()" class="btn btn-primary btn-xs">{{musicplayer.muteStatus}}</button>

					<div class="volumeContainer">
						<input class="volumeControl" ng-model="musicplayer.volume" ng-change="musicplayer.updateVolume()" type="range" min="0" max="100" value="50" />
						<p id="volumeText">{{musicplayer.volume}}</p>
					</div>

					<div id="bootVotes" ng-controller="BootVotes as bootVotes">
						<div id="bootVoteButtonContainer">
							<button ng-click="bootVotes.addBootVote()" class="btn btn-primary btn-xs">Vote to Boot</button>
						</div>
						<p align="center"> {{bootVotes.bootCount}} / {{bootVotes.userCount}} required to boot</p>
					</div>
				</div>
			</div>
			<div class="songQueue nano" ng-controller="MusicController as musicList">
				<div class="nano-content">
					<hr class="leftBar">
					<div class="track" ng-repeat="song in musicList.queue track by $index">
						<h1 class="track">{{song.title}} by {{song.username}}</h1>
						<hr class="leftBar">
					</div>
				</div>
			</div>
			<div class="userList nano" ng-controller="UserController as userList">
				<div class="nano-content">
					<div class="user" ng-repeat="user in userList.users track by $index">
						<img class="avatar" ng-src="/images/avatars/{{($index % 15) + 1}}.jpg"><h1 class="userName">{{user.name}}</h1>
					</div>
				</div>
			</div>
		</div>
		<div class="middleContainer">
			<div class="searchBar" ng-controller="SearchController as search" id="searchControl">
				<div class="search">
					<form ng-submit="search.search(search.query)">
						<input class="search" type="text" ng-model="search.query"  size="30"
						placeholder="Search">
						<input class="searchSubmit btn btn-primary btn-xs" type="submit" value="Search">
					</form>
				</div>

				<div class="searchResContainer">
					<table class="table table-hover table-condensed" style="width:100%">
						<!-- Headings for each column in the table-->
						<tr>
							<th>Title</th>
							<th>Duration</th>
							<th>Username</th>
							<th>Genre</th>
						</tr>

						<!-- Filter fields for each column-->
						<tr>
							<td>
								<div>
						        	<input type="text" ng-model="search.title" ng-change='filter()' size="30"
									placeholder="Title filter">
						      	</div>
							</td>

							<td>
								<form ng-submit="search.sortByDuration()">
									Sort
									<input type="checkbox" ng-model="search.ascending" ng-click='filter()'>
								</form>
							</td>

							<td>
								<form ng-submit="search.filter()">
									<input class="searchFilter" type="text" ng-model="search.user" ng-change='filter()' size="30"
									placeholder="User filter">
								</form>
							</td>
							<td>
								<form ng-submit="search.filter()">
									<input class="searchFilter" type="text" ng-model="search.genre" ng-change='filter()' size="30"
									placeholder="Genre filter">
								</form>
							</td>
						</tr>

						<!-- Display the results-->
						<tr ng-repeat="track in search.display">
							<td>{{track.title}} </td>
							<td>{{search.millisToMinutesAndSeconds(track.duration)}}</td>
							<td>{{track.user.username}}</td>
							<td>{{track.genre}}</td>
							<td>
								<form ng-submit="search.addSong($index)">
									<input class="btn btn-primary btn-xs" type="submit" value="Add">
								</form>
							</td>
						</tr>
					</table>
				</div>
			</div>
			<!-- <div ng-controller="SearchController as search">
				<div class="search">
					<form ng-submit="search.search(search.query)">
						<input class="search" type="text" ng-model="search.query" size="30" placeholder="Search">
						<input class="searchSubmit" type="submit">
						<input type="checkbox" id="remix"  ng-model="search.remix" ng-change="filter()" ng-true-value="'remix'" >
					</form>
				</div>
				<a target="_blank" href="http://soundcloud.com">
					<div class="poweredBy">
					</div>
				</a>
			</div> -->
			<!-- <div class="searchResContainer">
				<table class="table table-hover table-condensed" style="width:100%">
					<tr>
						<th>Title</th>
						<th>Duration</th>
						<th>Username</th>
						<th>Genre</th>
					</tr>

					<tr>
						<td>
							<div>
					        	<input type="text" ng-model="search.title" ng-change='filter()' size="30"
								placeholder="Title filter">
					      	</div>
						</td>

						<td>
							<form ng-submit="search.sortByDuration()">
								Sort
								<input type="checkbox" ng-model="search.ascending" ng-click='filter()'>
							</form>
						</td>

						<td>
							<form ng-submit="search.filter()">
								<input class="searchFilter" type="text" ng-model="search.user" ng-change='filter()' size="30"
								placeholder="User filter">
							</form>
						</td>
						<td>
							<form ng-submit="search.filter()">
								<input class="searchFilter" type="text" ng-model="search.genre" ng-change='filter()' size="30"
								placeholder="Genre filter">
							</form>
						</td>
					</tr>

					<tr ng-repeat="track in search.display">
						<td>{{track.title}} </td>
						<td>{{search.millisToMinutesAndSeconds(track.duration)}}</td>
						<td>{{track.user.username}}</td>
						<td>{{track.genre}}</td>
						<td>
							<form ng-submit="search.addSong($index)">
								<input class="btn btn-primary btn-xs" type="submit" value="Add">
							</form>
						</td>
					</tr>
				</table>
			</div> -->
			<div class="tiles" ng-controller="TileCtrl">
				<!-- 100 width tiles -->
				<div id="t100-1" class="tile s100" style="left: 0px; top: 0px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-2" class="tile s100" style="left: 0px; top: 100px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-3" class="tile s100" style="left: 0px; top: 400px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-4" class="tile s100" style="left: 100px; top: 400px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-5" class="tile s100" style="left: 300px; top: 500px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-6" class="tile s100" style="left: 400px; top: 500px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-7" class="tile s100" style="left: 600px; top: 300px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-8" class="tile s100" style="left: 500px; top: 300px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-9" class="tile s100" style="left: 600px; top: 0px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-10" class="tile s100" style="left: 500px; top: 0px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-11" class="tile s100" style="left: 700px; top: 0px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-12" class="tile s100" style="left: 700px; top: 100px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-13" class="tile s100" style="left: 800px; top: 400px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-14" class="tile s100" style="left: 800px; top: 500px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-15" class="tile s100" style="left: 900px; top: 200px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-16" class="tile s100" style="left: 500px; top: 700px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-17" class="tile s100" style="left: 200px; top: 800px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-18" class="tile s100" style="left: 0px; top: 1000px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-19" class="tile s100" style="left: 100px; top: 1000px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-20" class="tile s100" style="left: 200px; top: 1000px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-21" class="tile s100" style="left: 200px; top: 900px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-22" class="tile s100" style="left: 800px; top: 800px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-23" class="tile s100" style="left: 800px; top: 900px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-24" class="tile s100" style="left: 800px; top: 1000px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-25" class="tile s100" style="left: 1000px; top: 600px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-26" class="tile s100" style="left: 1000px; top: 700px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-27" class="tile s100" style="left: 1200px; top: 500px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-28" class="tile s100" style="left: 1400px; top: 400px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-29" class="tile s100" style="left: 1500px; top: 400px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-30" class="tile s100" style="left: 1500px; top: 0px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-31" class="tile s100" style="left: 1500px; top: 100px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-32" class="tile s100" style="left: 1300px; top: 200px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-33" class="tile s100" style="left: 1400px; top: 800px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-34" class="tile s100" style="left: 1500px; top: 800px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-35" class="tile s100" style="left: 1200px; top: 1000px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t100-36" class="tile s100" style="left: 1300px; top: 1000px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>

				<!-- 200 width tiles -->
				<div id="t200-1" class="tile s200" style="left: 100px; top: 0px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t200-2" class="tile s200" style="left: 0px; top: 200px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t200-3" class="tile s200" style="left: 300px; top: 600px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t200-4" class="tile s200" style="left: 700px; top: 200px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t200-5" class="tile s200" style="left: 300px; top: 0px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t200-6" class="tile s200" style="left: 500px; top: 100px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t200-7" class="tile s200" style="left: 800px; top: 0px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t200-8" class="tile s200" style="left: 800px; top: 600px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t200-9" class="tile s200" style="left: 600px; top: 700px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t200-10" class="tile s200" style="left: 0px; top: 800px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t200-11" class="tile s200" style="left: 600px; top: 900px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t200-12" class="tile s200" style="left: 1100px; top: 600px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t200-13" class="tile s200" style="left: 1200px; top: 300px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t200-14" class="tile s200" style="left: 1400px; top: 200px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t200-15" class="tile s200" style="left: 1300px; top: 0px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t200-16" class="tile s200" style="left: 1200px; top: 800px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t200-17" class="tile s200" style="left: 1400px; top: 900px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>

				<!-- 300 width tiles -->
				<div id="t300-1" class="tile s300" style="left: 200px; top: 200px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t300-2" class="tile s300" style="left: 0px; top: 500px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t300-3" class="tile s300" style="left: 500px; top: 400px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t300-4" class="tile s300" style="left: 900px; top: 300px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t300-5" class="tile s300" style="left: 1000px; top: 0px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t300-6" class="tile s300" style="left: 300px; top: 800px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t300-7" class="tile s300" style="left: 900px; top: 800px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<div id="t300-8" class="tile s300" style="left: 1300px; top: 500px;">
					<div class="front"> 
					</div> 
					<div class="back">
					</div> 
				</div>
				<script>
					$("div.tiles").hide();

					var ones = ["t100-1", "t100-2", "t100-3", "t100-4", "t100-5", "t100-6", "t100-7", "t100-8", "t100-9", "t100-10", "t100-11", "t100-12", "t100-13", "t100-14", "t100-15", "t100-16", "t100-17", "t100-18", "t100-19", "t100-20", "t100-21", "t100-22", "t100-23", "t100-24", "t100-25", "t100-26", "t100-27", "t100-28", "t100-29", "t100-30", "t100-31", "t100-32", "t100-33", "t100-34", "t100-35", "t100-36"];
					var twos = ["t200-1", "t200-2", "t200-3", "t200-4", "t200-5", "t200-6", "t200-7", "t200-8", "t200-9", "t200-10", "t200-11", "t200-12", "t200-13", "t200-14", "t200-15", "t200-16", "t200-17"];
					var threes = ["t300-1", "t300-2", "t300-3", "t300-4", "t300-5", "t300-6", "t300-7", "t300-8"];
					var albums = ["album1.jpg","album14.jpg","album19.jpg","album23.png","album28.jpg","album6.jpg","album10.jpg","album15.jpg","album2.jpg","album24.jpg","album29.jpg","album7.jpg","album11.png","album16.jpg","album20.jpg","album25.jpg","album3.jpg","album8.jpg","album12.jpg","album17.jpg","album21.jpg","album26.jpg","album4.png","album9.jpg","album13.jpg","album18.jpg","album22.jpg","album27.jpg","album5.jpg"];

					for (one in ones) {
						/*var index = Math.floor(Math.random() * ({{scope.tracks}}.length));
						var div = document.getElementById(ones[one]);
						var front = div.getElementsByClassName(".front")[0];
						var back = div.getElementsByClassName(".back")[0];
						front.style.backgroundImage = "url(" + scope.albumArt(scope.tracks[index].frontTrack) + ")";
						back.style.backgroundImage = "url(" + scope.albumArt(scope.tracks[index].backTrack) + ")";
						$(document.getElementById(ones[one])).click(function() {
							this.flip();
						});*/
						var index = Math.floor(Math.random() * (albums.length));
						document.getElementById(ones[one]).style.backgroundImage = "url('/images/albumArt/" + albums[index] + "')";
						$(document.getElementById(ones[one])).click(function() {
							var index = Math.floor(Math.random() * (albums.length));
							this.style.backgroundImage = "url('/images/albumArt/" + albums[index] + "')";
						});
					}
					for (two in twos) {
						var index = Math.floor(Math.random() * (albums.length));
						document.getElementById(twos[two]).style.backgroundImage = "url('/images/albumArt/" + albums[index] + "')";
						$(document.getElementById(twos[two])).click(function() {
							var index = Math.floor(Math.random() * (albums.length));
							this.style.backgroundImage = "url('/images/albumArt/" + albums[index] + "')";
						});
					}
					for (three in threes) {
						var index = Math.floor(Math.random() * (albums.length));
						document.getElementById(threes[three]).style.backgroundImage = "url('/images/albumArt/" + albums[index] + "')";
						$(document.getElementById(threes[three])).click(function() {
							var index = Math.floor(Math.random() * (albums.length));
							this.style.backgroundImage = "url('/images/albumArt/" + albums[index] + "')";
						});
					}
				</script>
			</div>
		</div>
		<div class="rightContainer">
			<div class="chatContainer" ng-controller="ChatController">
				<div class="roomName">
					<h1 contenteditable="true" class="roomName">Room Name</h1>
					<hr class="chat">
				</div>
				
				<div class="chatStream">
					<div class="messagesContainer nano">
						<div class="messages nano-content">
							<div class="chatMessage" ng-repeat="message in receivedMessages">
								<p class="chatMessage"><span class="userName">{{message.name}}</span><span class="colon">:</span>{{message.message}}</p>
							</div>
						</div>
					</div>
				</div>
				<div class="chatTextArea">
					<hr class="chat">
					<textarea class="chatTextArea" placeholder="Send a message" ng-model="message" ng-enter="sendMessage()"></input>
				</div>
			</div>
		</div>
	</body>
</html>